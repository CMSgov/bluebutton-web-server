{% extends "base.html" %}
{% load i18n %}
{% load static %}

{% block bannerBackButton %}{% endblock %}

{% block bannerTitle %}
Blue Button 2.0 API Test Client
{% endblock %}

{% block bannerDescription %}
The Blue Button 2.0 API Test Client allows you to quickly see what it is like for a Medicare beneficiary to grant access to an application. It allows allows you to see sample data returned from our various API endpoints.
{% endblock %}

{% block bannerCallToActionButtons %}
{% endblock %}

{% block Content %}

<div class="container">
  <div class="ds-l-row ds-u-justify-content--center ds-u-margin-y--4">
    <div class="ds-l-lg-col--11 ds-l-md-col--11 ds-l-sm-col--12">

			{% if user.is_authenticated %}
			<div class="ds-c-alert ds-c-alert--warn ds-u-margin-bottom--4">
				<div class="ds-c-alert__body">
					<h3 class="ds-c-alert__heading">Log out to continue</h3>
					<p class="ds-c-alert__text" role="alert">
						It looks like you may be logged in to your Sandbox developer account. Because the Test Client mimics the behavior of an anonymous user authenticating with Blue Button 2.0, you must be logged out of your Sandbox account to use the Test Client. Otherwise you will receive a 500 error.
					</p>
					<a href="{% url 'logout' %}" class="ds-c-button ds-u-margin-y--2 ds-c-button--primary ds-u-color--white">Log Out to Continue</a>
				</div>
			</div>
			{% endif %}

			<h2>Step 1: Sample Authorization</h2>

			<p>These calls require a token to be attached to your session.  The
test redirect_uri callback function {% url 'testclient-callback' %} will do this for you.<br/>
 Use this <a href="{% url 'authorize_link' %}">sample Authorization flow</a> to set the token, then come back here to make the calls.
 Calls requiring an access token will fail unless the above step is completed.
 </p>
 <br />
<a href="{% url 'authorize_link' %}" class="ds-c-button ds-u-margin-y--2 ds-c-button--primary ds-u-color--white">Get a Sample Authorization Token</a>
     <h1>API Calls</h1>
     <ul>

     <li> <a target="_blank" href="{% url 'test_eob' %}">ExplanationOfBenefit</a> </li>
     <li> <a target="_blank" href="{% url 'test_patient' %}">Patient</a> </li>
     <li> <a target="_blank" href="{% url 'test_coverage' %}">Coverage</a> </li>
     <li> <a target="_blank" href="{% url 'test_userinfo' %}">Profile </a> (OIDC Userinfo)</li>
     <li> <a target="_blank" href="{% url 'fhir_conformance_metadata' %}?format=json">FHIR Metadata </a>(No Token Needed) </li>
     <li> <a target="_blank" href="{% url 'openid-configuration' %}">OIDC Discovery </a>(No Token Needed) </li>
     </ul>
    {% if not request.user.is_authenticated %}
      <h2><a href="{% url 'login' %}">Login to the developer portal</a> </h1>
     {% endif %}

		</div>
	</div>
</div>
    
{% endblock %}
